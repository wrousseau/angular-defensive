{"version":3,"sources":["angular-defensive.js"],"names":[],"mappings":"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","file":"angular-defensive.js","sourcesContent":["(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n\ttypeof define === 'function' && define.amd ? define(factory) :\n\tglobal.angularDefensive = factory();\n}(this, function () { 'use strict';\n\n\tconst HTTP = new WeakMap();\n\tconst Q$1 = new WeakMap();\n\tconst TEMPLATE_CACHE = new WeakMap();\n\n\tclass DefensiveConfiguration {\n\n\t  /*@ngInject*/\n\t  constructor($http, $q, $templateCache) {\n\t    HTTP.set(this, $http);\n\t    Q$1.set(this, $q);\n\t    TEMPLATE_CACHE.set(this, $templateCache);\n\t    this.configurations = {};\n\t  }\n\n\t  static get Configuration() {\n\t    return class Configuration {\n\t      constructor() {\n\t        this.cases = [];\n\t      }\n\n\t      addCase(confCase) {\n\t        this.cases.push(confCase);\n\t        return this;\n\t      }\n\t    };\n\t  }\n\n\t  get Configuration() {\n\t    return DefensiveConfiguration.Configuration;\n\t  }\n\n\t  registerConfiguration(configurationName) {\n\t    let configuration = new this.Configuration();\n\t    this.configurations[configurationName] = configuration;\n\t    return configuration;\n\t  }\n\n\t  getTemplate(confCase) {\n\t    let self = this;\n\t    return new Promise(function(resolve) {\n\t      if (confCase.hasOwnProperty('template')) {\n\t        resolve(confCase.template);\n\t      } else if (confCase.hasOwnProperty('templateUrl')) {\n\t        HTTP.get(self)\n\t        .get(confCase.templateUrl, {\n\t          cache: TEMPLATE_CACHE.get(self),\n\t          headers: {Accept: 'text/html'}\n\t        })\n\t        .then(function(response) {\n\t          resolve(response.data);\n\t        });\n\t      }\n\t    });\n\t  }\n\n\t  promiseWrap(check) {\n\t    let deferred = Q$1.get(this).defer();\n\t    Q$1.get(this).when(check())\n\t    .then(function(result) {\n\t      if (result === false) {\n\t        deferred.reject();\n\t      } else {\n\t        deferred.resolve();\n\t      }\n\t    })\n\t    .catch(function() {\n\t      deferred.reject();\n\t    });\n\t    return deferred.promise;\n\t  }\n\n\t  getDefensiveCase(configurationName) {\n\t    let self = this;\n\t    return new Promise(function(resolve, reject) {\n\t      if (!self.configurations.hasOwnProperty(configurationName)) {\n\t        return reject(`Configuration ${configurationName} does not exist`);\n\t      }\n\t      let cases = self.configurations[configurationName].cases.slice();\n\t      while (cases.length) {\n\t        let confCase = cases.shift();\n\t        self.promiseWrap(confCase.check)\n\t        .then(function() {\n\t          return self.getTemplate(confCase);\n\t        })\n\t        .then(function(template) {\n\t          confCase.template = template;\n\t          return resolve(confCase);\n\t        });\n\t      }\n\t    });\n\t  }\n\n\t}\n\n\tDefensiveConfiguration.$inject = ['$http', '$q', '$templateCache'];\n\n\tconst Q = new WeakMap();\n\tconst CONNECTION_STATUS = new WeakMap();\n\n\tclass CheckPreset {\n\n\t  /*@ngInject*/\n\t  constructor($q, connectionStatus) {\n\t    Q.set(this, $q);\n\t    CONNECTION_STATUS.set(this, connectionStatus);\n\t  }\n\n\t  noNetwork() {\n\t    return !CONNECTION_STATUS.get(this).isOnline();\n\t  }\n\n\t  geolocationNotSupported() {\n\t    return !navigator.geolocation;\n\t  }\n\n\t  geolocationNotAvailable() {\n\t    let deferred = Q.get(this).defer();\n\t    if (navigator.geolocation) {\n\t      navigator.geolocation.getCurrentPosition(function() {\n\t        deferred.reject();\n\t      }, function() {\n\t        deferred.resolve();\n\t      });\n\t    } else {\n\t      deferred.resolve();\n\t    }\n\t    return deferred.promise;\n\t  }\n\n\t}\n\n\tCheckPreset.$inject = ['$q', 'connectionStatus'];\n\n\tvar moduleName$2 = 'ngDefensive.services';\n\n\tangular.module(moduleName$2, ['offline'])\n\t  .service('CheckPreset', CheckPreset)\n\t  .service('DefensiveConfiguration', DefensiveConfiguration);\n\n\tconst COMPILE = new WeakMap();\n\tconst DEFENSIVE_CONFIGURATION = new WeakMap();\n\n\tclass NgDefensive {\n\n\t  /*@ngInject*/\n\t  constructor($compile, DefensiveConfiguration) {\n\t    this.restrict = 'A';\n\t    COMPILE.set(this, $compile);\n\t    DEFENSIVE_CONFIGURATION.set(this, DefensiveConfiguration);\n\t  }\n\n\t  link(scope, element, attrs) {\n\t    let activeCase = null;\n\t    let DefensiveConfiguration = DEFENSIVE_CONFIGURATION.get(NgDefensive.instance);\n\t    DefensiveConfiguration.getDefensiveCase(attrs.ngDefensive)\n\t    .then(function(confCase) {\n\t      let $compile = COMPILE.get(NgDefensive.instance);\n\t      element.replaceWith($compile(confCase.template)(scope));\n\t      activeCase = confCase;\n\t    });\n\t    scope.action = function() {\n\t      scope.$eval(attrs.ngDefensiveCallbacks)[activeCase.caseName]();\n\t    };\n\t  }\n\n\t  static factory($compile, DefensiveConfiguration) {\n\t    NgDefensive.instance = new NgDefensive($compile, DefensiveConfiguration);\n\t    return NgDefensive.instance;\n\t  }\n\n\t}\n\n\tNgDefensive.factory.$inject = [\n\t  '$compile',\n\t  'DefensiveConfiguration'\n\t];\n\n\tvar moduleName$1 = 'ngDefensive.directives';\n\n\tangular.module(moduleName$1, [])\n\t  .directive('ngDefensive', NgDefensive.factory);\n\n\tvar moduleName = 'ngDefensive';\n\n\tvar app = angular.module(moduleName, [\n\t\tmoduleName$1,\n\t\tmoduleName$2\n\t]);\n\n\treturn moduleName;\n\n}));"],"sourceRoot":"/source/"}