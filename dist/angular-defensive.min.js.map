{"version":3,"sources":["angular-defensive.min.js","/source/angular-defensive.js"],"names":["_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","protoProps","staticProps","prototype","global","factory","exports","module","define","amd","angularDefensive","this","HTTP","WeakMap","TEMPLATE_CACHE","DefensiveConfiguration","$http","$templateCache","set","configurations","value","configurationName","configuration","Configuration","confCase","self","Promise","resolve","hasOwnProperty","template","get","templateUrl","cache","headers","Accept","then","response","data","reject","_loop","cases","shift","check","v","getTemplate","_ret","push","moduleName$2","angular","NgDefensive","$compile","restrict","scope","callbacks","link","element","attrs","activeCase","getDefensiveCase","ngDefensive","replaceWith","action","caseName","moduleName$1","directive","moduleName"],"mappings":"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","file":"angular-defensive.min.js","sourcesContent":["var _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\n(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() : typeof define === 'function' && define.amd ? define(factory) : global.angularDefensive = factory();\n})(this, function () {\n\t'use strict';\n\n\tvar HTTP = new WeakMap();\n\tvar TEMPLATE_CACHE = new WeakMap();\n\n\tvar DefensiveConfiguration = (function () {\n\t\tfunction DefensiveConfiguration($http, $templateCache) {\n\t\t\t_classCallCheck(this, DefensiveConfiguration);\n\n\t\t\tHTTP.set(this, $http);\n\t\t\tTEMPLATE_CACHE.set(this, $templateCache);\n\t\t\tthis.configurations = {};\n\t\t}\n\n\t\t_createClass(DefensiveConfiguration, [{\n\t\t\tkey: 'registerConfiguration',\n\t\t\tvalue: function registerConfiguration(configurationName) {\n\t\t\t\tvar configuration = new this.Configuration();\n\t\t\t\tthis.configurations[configurationName] = configuration;\n\t\t\t\treturn configuration;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'getTemplate',\n\t\t\tvalue: function getTemplate(confCase) {\n\t\t\t\tvar self = this;\n\t\t\t\treturn new Promise(function (resolve) {\n\t\t\t\t\tif (confCase.hasOwnProperty('template')) {\n\t\t\t\t\t\tresolve(confCase.template);\n\t\t\t\t\t} else if (confCase.hasOwnProperty('templateUrl')) {\n\t\t\t\t\t\tHTTP.get(self).get(confCase.templateUrl, {\n\t\t\t\t\t\t\tcache: TEMPLATE_CACHE.get(self),\n\t\t\t\t\t\t\theaders: { Accept: 'text/html' }\n\t\t\t\t\t\t}).then(function (response) {\n\t\t\t\t\t\t\tresolve(response.data);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'getDefensiveCase',\n\t\t\tvalue: function getDefensiveCase(configurationName) {\n\t\t\t\tvar self = this;\n\t\t\t\treturn new Promise(function (resolve, reject) {\n\t\t\t\t\tif (!self.configurations.hasOwnProperty(configurationName)) {\n\t\t\t\t\t\treturn reject('Configuration ' + configurationName + ' does not exist');\n\t\t\t\t\t}\n\t\t\t\t\tvar configuration = self.configurations[configurationName];\n\n\t\t\t\t\tvar _loop = function () {\n\t\t\t\t\t\tvar confCase = configuration.cases.shift();\n\t\t\t\t\t\tif (confCase.check()) {\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\tv: self.getTemplate(confCase).then(function (template) {\n\t\t\t\t\t\t\t\t\tconfCase.template = template;\n\t\t\t\t\t\t\t\t\treturn resolve(confCase);\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\n\t\t\t\t\twhile (configuration.cases.length) {\n\t\t\t\t\t\tvar _ret = _loop();\n\n\t\t\t\t\t\tif (typeof _ret === 'object') return _ret.v;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'Configuration',\n\t\t\tget: function get() {\n\t\t\t\treturn DefensiveConfiguration.Configuration;\n\t\t\t}\n\t\t}], [{\n\t\t\tkey: 'factory',\n\t\t\tvalue: function factory($http, $templateCache) {\n\t\t\t\treturn new DefensiveConfiguration($http, $templateCache);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'Configuration',\n\t\t\tget: function get() {\n\t\t\t\treturn (function () {\n\t\t\t\t\tfunction Configuration() {\n\t\t\t\t\t\t_classCallCheck(this, Configuration);\n\n\t\t\t\t\t\tthis.cases = [];\n\t\t\t\t\t}\n\n\t\t\t\t\t_createClass(Configuration, [{\n\t\t\t\t\t\tkey: 'addCase',\n\t\t\t\t\t\tvalue: function addCase(confCase) {\n\t\t\t\t\t\t\tthis.cases.push(confCase);\n\t\t\t\t\t\t\treturn this;\n\t\t\t\t\t\t}\n\t\t\t\t\t}]);\n\n\t\t\t\t\treturn Configuration;\n\t\t\t\t})();\n\t\t\t}\n\t\t}]);\n\n\t\treturn DefensiveConfiguration;\n\t})();\n\n\tvar moduleName$2 = 'ngDefensive.services';\n\n\tangular.module(moduleName$2, []).factory('DefensiveConfiguration', DefensiveConfiguration.factory);\n\n\tvar NgDefensive = (function () {\n\t\tfunction NgDefensive($compile, DefensiveConfiguration) {\n\t\t\t_classCallCheck(this, NgDefensive);\n\n\t\t\tthis.restrict = 'A';\n\t\t\tthis.scope = {\n\t\t\t\tcallbacks: '=ngDefensiveCallbacks'\n\t\t\t};\n\t\t\tthis.link = function (scope, element, attrs) {\n\t\t\t\tvar activeCase = null;\n\t\t\t\tDefensiveConfiguration.getDefensiveCase(attrs.ngDefensive).then(function (confCase) {\n\t\t\t\t\telement.replaceWith($compile(confCase.template)(scope));\n\t\t\t\t\tactiveCase = confCase;\n\t\t\t\t});\n\t\t\t\tscope.action = function () {\n\t\t\t\t\tscope.callbacks[activeCase.caseName]();\n\t\t\t\t};\n\t\t\t};\n\t\t}\n\n\t\t_createClass(NgDefensive, null, [{\n\t\t\tkey: 'factory',\n\t\t\tvalue: function factory($compile, DefensiveConfiguration) {\n\t\t\t\treturn new NgDefensive($compile, DefensiveConfiguration);\n\t\t\t}\n\t\t}]);\n\n\t\treturn NgDefensive;\n\t})();\n\n\tvar moduleName$1 = 'ngDefensive.directives';\n\n\tangular.module(moduleName$1, []).directive('ngDefensive', NgDefensive.factory);\n\n\tvar moduleName = 'ngDefensive';\n\n\tvar app = angular.module(moduleName, [moduleName$1, moduleName$2]);\n\n\treturn moduleName;\n});\n//# sourceMappingURL=angular-defensive.js.map\n","(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n\ttypeof define === 'function' && define.amd ? define(factory) :\n\tglobal.angularDefensive = factory();\n}(this, function () { 'use strict';\n\n\tconst HTTP = new WeakMap();\n\tconst TEMPLATE_CACHE = new WeakMap();\n\n\tclass DefensiveConfiguration {\n\n\t  constructor($http, $templateCache) {\n\t    HTTP.set(this, $http);\n\t    TEMPLATE_CACHE.set(this, $templateCache);\n\t    this.configurations = {};\n\t  }\n\n\t  static get Configuration() {\n\t    return class Configuration {\n\t      constructor() {\n\t        this.cases = [];\n\t      }\n\n\t      addCase(confCase) {\n\t        this.cases.push(confCase);\n\t        return this;\n\t      }\n\t    };\n\t  }\n\n\t  get Configuration() {\n\t    return DefensiveConfiguration.Configuration;\n\t  }\n\n\t  registerConfiguration(configurationName) {\n\t    let configuration = new this.Configuration();\n\t    this.configurations[configurationName] = configuration;\n\t    return configuration;\n\t  }\n\n\t  getTemplate(confCase) {\n\t    let self = this;\n\t    return new Promise(function(resolve) {\n\t      if (confCase.hasOwnProperty('template')) {\n\t        resolve(confCase.template);\n\t      } else if (confCase.hasOwnProperty('templateUrl')) {\n\t        HTTP.get(self)\n\t          .get(confCase.templateUrl, {\n\t            cache: TEMPLATE_CACHE.get(self),\n\t            headers: {Accept: 'text/html'}\n\t          })\n\t          .then(function(response) {\n\t            resolve(response.data);\n\t          });\n\t      }\n\t    });\n\t  }\n\n\t  getDefensiveCase(configurationName) {\n\t    let self = this;\n\t    return new Promise(function(resolve, reject) {\n\t      if (!self.configurations.hasOwnProperty(configurationName)) {\n\t        return reject(`Configuration ${configurationName} does not exist`);\n\t      }\n\t      let configuration = self.configurations[configurationName];\n\t      while (configuration.cases.length) {\n\t        let confCase = configuration.cases.shift();\n\t        if (confCase.check()) {\n\t          return self.getTemplate(confCase)\n\t          .then(function(template) {\n\t            confCase.template = template;\n\t            return resolve(confCase);\n\t          });\n\t        }\n\t      }\n\t    });\n\t  }\n\n\t  static factory($http, $templateCache) {\n\t    return new DefensiveConfiguration($http, $templateCache);\n\t  }\n\n\t}\n\n\tvar moduleName$2 = 'ngDefensive.services';\n\n\tangular.module(moduleName$2, [])\n\t  .factory('DefensiveConfiguration', DefensiveConfiguration.factory);\n\n\tclass NgDefensive {\n\n\t  constructor($compile, DefensiveConfiguration) {\n\t    this.restrict = 'A';\n\t    this.scope = {\n\t      callbacks: '=ngDefensiveCallbacks'\n\t    };\n\t    this.link = function(scope, element, attrs) {\n\t      let activeCase = null;\n\t      DefensiveConfiguration.getDefensiveCase(attrs.ngDefensive)\n\t      .then(function(confCase) {\n\t        element.replaceWith($compile(confCase.template)(scope));\n\t        activeCase = confCase;\n\t      });\n\t      scope.action = function() {\n\t        scope.callbacks[activeCase.caseName]();\n\t      };\n\t    };\n\t  }\n\n\t  static factory($compile, DefensiveConfiguration) {\n\t    return new NgDefensive($compile, DefensiveConfiguration);\n\t  }\n\n\t}\n\n\tvar moduleName$1 = 'ngDefensive.directives';\n\n\tangular.module(moduleName$1, [])\n\t  .directive('ngDefensive', NgDefensive.factory);\n\n\tvar moduleName = 'ngDefensive';\n\n\tvar app = angular.module(moduleName, [\n\t\tmoduleName$1,\n\t\tmoduleName$2\n\t]);\n\n\treturn moduleName;\n\n}));"],"sourceRoot":"/source/"}